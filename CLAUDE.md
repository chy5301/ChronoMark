# CLAUDE.md

è¯¥æ–‡ä»¶ä¸º Claude Codeï¼ˆclaude.ai/codeï¼‰åœ¨å¤„ç†æœ¬ä»£ç åº“æ—¶æä¾›æŒ‡å¯¼ã€‚

## é¡¹ç›®æ¦‚è¿°

ChronoMark æ˜¯ä¸€ä¸ªåŸºäº Jetpack Compose çš„ Android æ—¶é—´è®°å½•åº”ç”¨ã€‚**æ ¸å¿ƒç‰¹è‰²æ˜¯"äº‹ä»¶æ¨¡å¼"â€”â€”ä¸€é”®è®°å½•å½“å‰ä¸–ç•Œæ—¶é—´ï¼Œæ— éœ€å¯åŠ¨è®¡æ—¶å™¨**ï¼Œé€‚åˆå¿«é€Ÿè®°å½•è§‚å¯Ÿç‚¹ã€é‡è¦æ—¶åˆ»æˆ–æ—¶é—´èŠ‚ç‚¹ã€‚åŒæ—¶æä¾›ä¼ ç»Ÿç§’è¡¨æ¨¡å¼ï¼Œæ»¡è¶³ä¸åŒåœºæ™¯éœ€æ±‚ã€‚

åº”ç”¨æä¾›**äº‹ä»¶**å’Œ**ç§’è¡¨**ä¸¤ç§ç‹¬ç«‹çš„è®°å½•æ¨¡å¼ï¼š

- **äº‹ä»¶æ¨¡å¼**ï¼ˆæ¨èï¼‰ï¼šæç®€æ—¶é—´ç‚¹è®°å½•å·¥å…·ï¼Œæ— éœ€è®¡æ—¶å™¨ï¼Œä¸€é”®è®°å½•å½“å‰ä¸–ç•Œæ—¶é—´ï¼ˆç²¾ç¡®åˆ°æ¯«ç§’ï¼‰ï¼Œå¯å¿«é€Ÿæ·»åŠ å¤‡æ³¨ã€‚**åŒºåˆ«äºä¼ ç»Ÿç§’è¡¨éœ€è¦"å¼€å§‹-æ ‡è®°-åœæ­¢"çš„æ“ä½œæµç¨‹ï¼Œäº‹ä»¶æ¨¡å¼éšæ—¶éšåœ°ä¸€é”®è®°å½•**
- **ç§’è¡¨æ¨¡å¼**ï¼šä¼ ç»Ÿç§’è¡¨è®¾è®¡ï¼Œæ”¯æŒé«˜ç²¾åº¦è®¡æ—¶ï¼ˆæ¯«ç§’çº§ï¼‰ã€å®Œæ•´çš„è®¡æ—¶æ§åˆ¶ï¼ˆå¼€å§‹/æš‚åœ/ç»§ç»­/åœæ­¢/é‡ç½®ï¼‰ã€è¿è¡Œä¸­ç¬é—´æ ‡è®°æ—¶é—´ç‚¹ï¼Œ**æ¯ä¸ªæ ‡è®°ç‚¹ä¸ä»…è®°å½•ç´¯è®¡æ—¶é—´å’Œæ—¶é—´å·®ï¼Œè¿˜è®°å½•å®é™…çš„ä¸–ç•Œæ—¶é—´**ï¼ˆç²¾ç¡®åˆ°æ¯«ç§’ï¼‰

**æ ¸å¿ƒç‰¹æ€§**ï¼š
- ä¸€é”®è®°å½•ï¼šäº‹ä»¶æ¨¡å¼æ— éœ€å¯åŠ¨è®¡æ—¶å™¨ï¼Œéšæ—¶è®°å½•å½“å‰æ—¶åˆ»
- ä¸–ç•Œæ—¶é—´ï¼šä¸ä»…çŸ¥é“"ç»è¿‡äº†å¤šä¹…"ï¼Œè¿˜èƒ½è¿½æº¯"ä½•æ—¶å‘ç”Ÿ"
- æ•°æ®æŒä¹…åŒ–ï¼šDataStore + Room æ•°æ®åº“ï¼Œåº”ç”¨é‡å¯åè‡ªåŠ¨æ¢å¤
- å†å²è®°å½•ï¼šäº‹ä»¶æ¨¡å¼è‡ªåŠ¨æŒ‰å¤©å½’æ¡£ï¼Œç§’è¡¨æ¨¡å¼æ‰‹åŠ¨ä¿å­˜ä¼šè¯ï¼Œå¯é…ç½®å½’æ¡£åˆ†ç•Œç‚¹
- ä¾¿æ·åˆ†äº«ï¼šä¸€é”®ç”Ÿæˆæ ¼å¼åŒ–æ–‡æœ¬ï¼Œå¯åˆ†äº«åˆ°ä»»æ„åº”ç”¨æˆ–å¤åˆ¶
- å®ç”¨è®¾ç½®ï¼šä¸»é¢˜åˆ‡æ¢ã€ä¿æŒå±å¹•å¸¸äº®ã€éœ‡åŠ¨åé¦ˆã€å½’æ¡£é…ç½®
- ç°ä»£è®¾è®¡ï¼šMaterial3 ä¸»é¢˜ï¼Œæ”¯æŒäº®è‰²/æ·±è‰²æ¨¡å¼

ä¸¤ç§æ¨¡å¼æ•°æ®ç‹¬ç«‹å­˜å‚¨ï¼Œäº’ä¸å¹²æ‰°ã€‚

## é¡¹ç›®çŠ¶æ€

**å½“å‰ç‰ˆæœ¬**: v1.0.0 æ­£å¼ç‰ˆ âœ… å·²å‘å¸ƒï¼ˆ2025-12-31ï¼‰

### v1.0.0 ä¸»è¦åŠŸèƒ½
- âœ… åŒæ¨¡å¼è®¾è®¡ï¼šäº‹ä»¶æ¨¡å¼ + ç§’è¡¨æ¨¡å¼
- âœ… é«˜ç²¾åº¦è®¡æ—¶ï¼ˆæ¯«ç§’çº§ï¼Œä½¿ç”¨ nanoTimeï¼‰
- âœ… åŒæ—¶é—´æ˜¾ç¤ºï¼ˆè®¡æ—¶å™¨ + ä¸–ç•Œæ—¶é—´ï¼Œç²¾ç¡®åˆ°æ¯«ç§’ï¼‰
- âœ… æ•°æ®æŒä¹…åŒ–ï¼ˆDataStore + Room æ•°æ®åº“ï¼‰
- âœ… å†å²è®°å½•åŠŸèƒ½ï¼ˆè‡ªåŠ¨/æ‰‹åŠ¨å½’æ¡£ã€æ—¥æœŸé€‰æ‹©ã€ä¼šè¯ç®¡ç†ï¼‰
- âœ… è‡ªå®šä¹‰å½’æ¡£åˆ†ç•Œç‚¹ï¼ˆåŸºäºé€»è¾‘æ—¥æœŸï¼‰
- âœ… åˆ†äº«ä¸å¤åˆ¶åŠŸèƒ½ï¼ˆç³»ç»Ÿåˆ†äº«é¢æ¿ï¼‰
- âœ… è®¾ç½®é¡µé¢ï¼ˆä¸»é¢˜åˆ‡æ¢ã€ä¿æŒå¸¸äº®ã€éœ‡åŠ¨åé¦ˆã€å½’æ¡£é…ç½®ï¼‰
- âœ… ä»£ç é‡æ„ï¼ˆPhase 9ï¼‰ï¼šæå– 6 ä¸ªå…±äº«ç»„ä»¶ï¼Œå‡å°‘ 86% é‡å¤ä»£ç 
- âœ… R8 ä»£ç æ··æ·†ï¼šAPK ä½“ç§¯ä¼˜åŒ– 30-40%

### v1.1 è§„åˆ’
- ğŸ”„ è¿”å›é”®è¡Œä¸ºä¼˜åŒ–ï¼šä¸»ç•Œé¢åŒå‡»è¿”å›é€€å‡º
- ğŸ”„ è®°å½•æè¿°æ–‡æœ¬é•¿åº¦ä¼˜åŒ–ï¼šå¡ç‰‡æ˜¾ç¤ºé™åˆ¶ + è¯¦æƒ…çª—å£æ‰©å¤§
- ç»Ÿè®¡åŠŸèƒ½ï¼šè®°å½•æ•°è¶‹åŠ¿å›¾
- æœç´¢åŠŸèƒ½ï¼šæŒ‰å¤‡æ³¨æœç´¢
- æ ‡ç­¾ç³»ç»Ÿï¼šå·¥ä½œ/å­¦ä¹ /è¿åŠ¨åˆ†ç±»

## æŠ€æœ¯æ ˆ

- **å¼€å‘ç¯å¢ƒ**: JetBrains Runtime 21 (Android Studio è‡ªå¸¦ JDK)
- **UI æ¡†æ¶**: Jetpack Compose + Material3
- **è¯­è¨€**: Kotlin
- **æ„å»ºå·¥å…·**: Gradle (Kotlin DSL)
- **æœ€ä½ SDK**: 26 (Android 8.0)
- **ç›®æ ‡ SDK**: 36
- **é¡¹ç›®ç¼–è¯‘ç›®æ ‡**: Java 17
- **æ¶æ„æ¨¡å¼**: MVVM (Model-View-ViewModel)
- **å¼‚æ­¥å¤„ç†**: Kotlin Coroutines + Flow
- **çŠ¶æ€ç®¡ç†**: StateFlow
- **æ•°æ®æŒä¹…åŒ–**:
  - DataStoreï¼šåº”ç”¨è®¾ç½®å’Œå·¥ä½œåŒºæ•°æ®
  - Room æ•°æ®åº“ï¼šå†å²è®°å½•å­˜å‚¨
  - Kotlinx Serializationï¼šæ•°æ®åºåˆ—åŒ–
- **ä»£ç æ··æ·†**: R8 (ProGuard)
- **æ—¶é—´å¤„ç†**: java.time API (é«˜ç²¾åº¦ nanoTime)

## é¡¹ç›®ç»“æ„

```
app/src/main/java/io/github/chy5301/chronomark/
â”œâ”€â”€ MainActivity.kt              # ä¸»å…¥å£ Activity
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ DataStoreManager.kt      # DataStore ç®¡ç†å™¨ï¼ˆåº”ç”¨è®¾ç½® + å·¥ä½œåŒºæš‚å­˜ï¼‰
â”‚   â”œâ”€â”€ database/                # Room æ•°æ®åº“ï¼ˆå†å²è®°å½•å­˜å‚¨ï¼‰
â”‚   â”‚   â”œâ”€â”€ AppDatabase.kt       # æ•°æ®åº“å®ä¾‹ï¼ˆå•ä¾‹ï¼‰
â”‚   â”‚   â”œâ”€â”€ dao/
â”‚   â”‚   â”‚   â””â”€â”€ HistoryDao.kt    # å†å²è®°å½• DAO æ¥å£
â”‚   â”‚   â”œâ”€â”€ entity/
â”‚   â”‚   â”‚   â”œâ”€â”€ HistorySessionEntity.kt  # ä¼šè¯è¡¨å®ä½“
â”‚   â”‚   â”‚   â””â”€â”€ TimeRecordEntity.kt      # è®°å½•è¡¨å®ä½“
â”‚   â”‚   â””â”€â”€ repository/
â”‚   â”‚       â””â”€â”€ HistoryRepository.kt     # å†å²æ•°æ®ä»“åº“å±‚
â”‚   â””â”€â”€ model/
â”‚       â”œâ”€â”€ AppMode.kt           # åº”ç”¨æ¨¡å¼æšä¸¾ï¼ˆç§’è¡¨/äº‹ä»¶ï¼‰
â”‚       â”œâ”€â”€ TimeRecord.kt        # æ—¶é—´è®°å½•æ•°æ®æ¨¡å‹ï¼ˆå·¥ä½œåŒºä½¿ç”¨ï¼‰
â”‚       â”œâ”€â”€ StopwatchStatus.kt   # ç§’è¡¨çŠ¶æ€æšä¸¾
â”‚       â”œâ”€â”€ StopwatchUiState.kt  # ç§’è¡¨ UI çŠ¶æ€æ•°æ®ç±»
â”‚       â”œâ”€â”€ EventUiState.kt      # äº‹ä»¶ UI çŠ¶æ€æ•°æ®ç±»
â”‚       â”œâ”€â”€ HistoryUiState.kt    # å†å² UI çŠ¶æ€æ•°æ®ç±»
â”‚       â”œâ”€â”€ SessionType.kt       # ä¼šè¯ç±»å‹æšä¸¾ï¼ˆäº‹ä»¶/ç§’è¡¨ï¼‰
â”‚       â””â”€â”€ RecordCardMode.kt    # è®°å½•å¡ç‰‡æ¨¡å¼æšä¸¾
â”œâ”€â”€ ui/
â”‚   â”œâ”€â”€ screen/
â”‚   â”‚   â”œâ”€â”€ MainScreen.kt        # ä¸»å±å¹•ï¼ˆç®¡ç†æ¨¡å¼åˆ‡æ¢ï¼‰
â”‚   â”‚   â”œâ”€â”€ StopwatchScreen.kt   # ç§’è¡¨ä¸»å±å¹•
â”‚   â”‚   â”œâ”€â”€ EventScreen.kt       # äº‹ä»¶ä¸»å±å¹•
â”‚   â”‚   â”œâ”€â”€ HistoryScreen.kt     # å†å²è®°å½•ä¸»å±å¹•
â”‚   â”‚   â””â”€â”€ SettingsScreen.kt    # è®¾ç½®é¡µé¢
â”‚   â”œâ”€â”€ components/              # å…±äº«ç»„ä»¶å±‚ï¼ˆPhase 9 æå–ï¼‰
â”‚   â”‚   â”œâ”€â”€ navigation/
â”‚   â”‚   â”‚   â””â”€â”€ ModeNavigationBar.kt   # äº‹ä»¶/ç§’è¡¨å¯¼èˆªæ ï¼ˆæ³›å‹ï¼‰
â”‚   â”‚   â”œâ”€â”€ record/
â”‚   â”‚   â”‚   â””â”€â”€ UnifiedRecordCard.kt   # ç»Ÿä¸€è®°å½•å¡ç‰‡
â”‚   â”‚   â”œâ”€â”€ button/
â”‚   â”‚   â”‚   â””â”€â”€ ControlButton.kt       # æ§åˆ¶æŒ‰é’®
â”‚   â”‚   â””â”€â”€ dialog/
â”‚   â”‚       â”œâ”€â”€ ConfirmDialog.kt       # é€šç”¨ç¡®è®¤å¯¹è¯æ¡†
â”‚   â”‚       â””â”€â”€ EditRecordDialog.kt    # é€šç”¨ç¼–è¾‘å¯¹è¯æ¡†
â”‚   â””â”€â”€ theme/                   # Compose ä¸»é¢˜é…ç½®
â”‚       â”œâ”€â”€ Color.kt
â”‚       â”œâ”€â”€ Theme.kt
â”‚       â””â”€â”€ Type.kt
â”œâ”€â”€ util/
â”‚   â”œâ”€â”€ TimeFormatter.kt         # æ—¶é—´æ ¼å¼åŒ–å·¥å…·ç±»
â”‚   â”œâ”€â”€ ShareHelper.kt           # åˆ†äº«æ–‡æœ¬ç”Ÿæˆå·¥å…·ç±»
â”‚   â””â”€â”€ ArchiveUtils.kt          # å½’æ¡£å·¥å…·ï¼ˆé€»è¾‘æ—¥æœŸè®¡ç®—ï¼‰
â””â”€â”€ viewmodel/
    â”œâ”€â”€ StopwatchViewModel.kt    # ç§’è¡¨ä¸šåŠ¡é€»è¾‘å’ŒçŠ¶æ€ç®¡ç†
    â”œâ”€â”€ StopwatchViewModelFactory.kt  # ç§’è¡¨ ViewModel å·¥å‚
    â”œâ”€â”€ EventViewModel.kt        # äº‹ä»¶ä¸šåŠ¡é€»è¾‘å’ŒçŠ¶æ€ç®¡ç†
    â”œâ”€â”€ EventViewModelFactory.kt # äº‹ä»¶ ViewModel å·¥å‚
    â”œâ”€â”€ HistoryViewModel.kt      # å†å²è®°å½•ä¸šåŠ¡é€»è¾‘å’ŒçŠ¶æ€ç®¡ç†
    â””â”€â”€ HistoryViewModelFactory.kt  # å†å² ViewModel å·¥å‚
```

## å¸¸ç”¨å‘½ä»¤

> **æ³¨æ„**: æœ¬é¡¹ç›®å¼€å‘ç¯å¢ƒæ‰€æœ‰å‘½ä»¤ç¤ºä¾‹ä½¿ç”¨ `./gradlew`ï¼ˆBash ç¯å¢ƒï¼‰

### æ„å»ºå’Œè¿è¡Œ
```bash
# æ„å»ºé¡¹ç›®
./gradlew build

# æ„å»º Debug APK
./gradlew assembleDebug

# æ„å»º Release APKï¼ˆå¯ç”¨ R8 æ··æ·†ï¼‰
./gradlew assembleRelease

# å®‰è£…å¹¶è¿è¡Œ Debug ç‰ˆæœ¬
./gradlew installDebug
```

### æµ‹è¯•
```bash
# è¿è¡Œå•å…ƒæµ‹è¯•
./gradlew test

# è¿è¡Œ Android ä»ªå™¨åŒ–æµ‹è¯•
./gradlew connectedAndroidTest

# Lint æ£€æŸ¥
./gradlew lint
```

### ä»£ç è´¨é‡
```bash
# æ¸…ç†æ„å»ºäº§ç‰©
./gradlew clean
```

## ä¾èµ–ç®¡ç†

é¡¹ç›®ä½¿ç”¨ Gradle Version Catalog (`gradle/libs.versions.toml`) ç®¡ç†ä¾èµ–ç‰ˆæœ¬ã€‚æ·»åŠ æ–°ä¾èµ–æ—¶ï¼š

1. åœ¨ `libs.versions.toml` çš„ `[versions]` éƒ¨åˆ†æ·»åŠ ç‰ˆæœ¬å·
2. åœ¨ `[libraries]` æˆ– `[plugins]` éƒ¨åˆ†å®šä¹‰ä¾èµ–
3. åœ¨ `app/build.gradle.kts` ä¸­é€šè¿‡ `libs.` å¼•ç”¨

## æ ¸å¿ƒæ¶æ„è®¾è®¡

### æ¶æ„æ¨¡å¼
- **MVVM (Model-View-ViewModel)** é…åˆ Jetpack Compose
- ä½¿ç”¨ `ViewModel` ç®¡ç† UI çŠ¶æ€å’Œä¸šåŠ¡é€»è¾‘
- ä½¿ç”¨ `StateFlow` è¿›è¡ŒçŠ¶æ€ç®¡ç†
- ä½¿ç”¨ Coroutines å¤„ç†å¼‚æ­¥æ“ä½œå’Œè®¡æ—¶æ›´æ–°

### æ ¸å¿ƒåŠŸèƒ½æ¨¡å—

1. **ç§’è¡¨æ¨¡å¼**: é«˜ç²¾åº¦è®¡æ—¶ï¼ˆæ¯«ç§’çº§ï¼‰ï¼Œæ”¯æŒå¼€å§‹ã€æš‚åœã€ç»§ç»­ã€åœæ­¢ã€é‡ç½®ã€æ ‡è®°
2. **äº‹ä»¶æ¨¡å¼**: ç®€åŒ–çš„æ—¶é—´ç‚¹è®°å½•ï¼Œåªæœ‰è®°å½•å’Œé‡ç½®æ“ä½œï¼Œæ— è®¡æ—¶é€»è¾‘
3. **æ—¶é—´ç‚¹æ ‡è®°**: è¿è¡Œä¸­å¯ç¬é—´æ ‡è®°æ—¶é—´ç‚¹ï¼Œä¸ä¸­æ–­è®¡æ—¶æµç¨‹
4. **åŒæ—¶é—´æ˜¾ç¤º**: åŒæ—¶æ˜¾ç¤ºç´¯è®¡ç»è¿‡æ—¶é—´å’Œå½“å‰ä¸–ç•Œæ—¶é—´ï¼ˆç²¾ç¡®åˆ°æ¯«ç§’ï¼‰
5. **å¤‡æ³¨åŠŸèƒ½**: ä¸ºæ¯ä¸ªæ—¶é—´ç‚¹æ·»åŠ æ–‡å­—è¯´æ˜
6. **åˆ†äº«åŠŸèƒ½**: é€šè¿‡ç³»ç»Ÿåˆ†äº«é¢æ¿åˆ†äº«è®°å½•ï¼ˆæ ¼å¼åŒ–æ–‡æœ¬ï¼‰
7. **æ¨¡å¼åˆ‡æ¢**: åº•éƒ¨å¯¼èˆªæ åˆ‡æ¢ç§’è¡¨/äº‹ä»¶ä¸¤ç§æ¨¡å¼ï¼Œå†å²è®°å½•å’Œè®¾ç½®é€šè¿‡ TopAppBar æŒ‰é’®è®¿é—®
8. **å†å²è®°å½•**: äº‹ä»¶æ¨¡å¼è‡ªåŠ¨æŒ‰å¤©å½’æ¡£ï¼Œç§’è¡¨æ¨¡å¼æ‰‹åŠ¨ä¿å­˜ä¼šè¯

### æ•°æ®æ¨¡å‹è®¾è®¡

```kotlin
// æ—¶é—´è®°å½•ï¼ˆå·¥ä½œåŒºï¼‰
data class TimeRecord(
    val id: String = UUID.randomUUID().toString(),
    val index: Int,                   // åºå·
    val wallClockTime: Long,          // æ ‡è®°æ—¶çš„ç³»ç»Ÿæ—¶é—´æˆ³ï¼ˆæ¯«ç§’ï¼‰
    val elapsedTimeNanos: Long,       // ç´¯è®¡ç»è¿‡æ—¶é—´ï¼ˆçº³ç§’ï¼‰
    val splitTimeNanos: Long,         // ä¸ä¸Šæ¬¡çš„æ—¶é—´å·®ï¼ˆçº³ç§’ï¼‰
    val note: String = ""             // å¤‡æ³¨
)

// ç§’è¡¨çŠ¶æ€
sealed class StopwatchStatus {
    object Idle : StopwatchStatus()       // åˆå§‹çŠ¶æ€
    object Running : StopwatchStatus()    // è¿è¡Œä¸­
    object Paused : StopwatchStatus()     // æš‚åœ
    object Stopped : StopwatchStatus()    // åœæ­¢ï¼ˆæœ‰è®°å½•ï¼‰
}

// UI çŠ¶æ€
data class StopwatchUiState(
    val status: StopwatchStatus = StopwatchStatus.Idle,
    val currentTime: String = "00:00.000",
    val wallClockTime: String = "0000-00-00 00:00:00",
    val currentTimeNanos: Long = 0L,
    val records: List<TimeRecord> = emptyList()
)

// ä¼šè¯ç±»å‹
enum class SessionType {
    EVENT,      // äº‹ä»¶æ¨¡å¼
    STOPWATCH   // ç§’è¡¨æ¨¡å¼
}

// è®°å½•å¡ç‰‡æ¨¡å¼
enum class RecordCardMode {
    EVENT,              // äº‹ä»¶æ¨¡å¼ï¼ˆåªæ˜¾ç¤ºæ—¶é—´ï¼‰
    STOPWATCH,          // ç§’è¡¨æ¨¡å¼ï¼ˆæ˜¾ç¤ºç´¯è®¡/å·®å€¼/æ—¶é—´ï¼‰
    HISTORY_EVENT,      // å†å²äº‹ä»¶ï¼ˆæ ·å¼åŒ EVENTï¼‰
    HISTORY_STOPWATCH   // å†å²ç§’è¡¨ï¼ˆæ ·å¼åŒ STOPWATCHï¼‰
}
```

### æ•°æ®å­˜å‚¨æ¶æ„

```
DataStore (è½»é‡çº§)          â†’  å½’æ¡£  â†’    Room Database (æŒä¹…åŒ–)
- åº”ç”¨è®¾ç½®                                 - history_sessions è¡¨
- ç§’è¡¨å·¥ä½œåŒºï¼ˆå½“å‰çŠ¶æ€ï¼‰                    - time_records è¡¨
- äº‹ä»¶å·¥ä½œåŒºï¼ˆå½“å‰è®°å½•ï¼‰
```

**Room æ•°æ®åº“è®¾è®¡**ï¼š
- `history_sessions` è¡¨ï¼šä¼šè¯å…ƒæ•°æ®ï¼ˆid, date, sessionType, title, createdAt, totalElapsedNanos, startTime, endTimeï¼‰
- `time_records` è¡¨ï¼šæ—¶é—´è®°å½•è¯¦æƒ…ï¼ˆid, sessionId, index, wallClockTime, elapsedTimeNanos, splitTimeNanos, noteï¼‰
- å¤–é”®å…³è”ï¼š`time_records.sessionId` â†’ `history_sessions.id`ï¼ˆçº§è”åˆ é™¤ï¼‰
- ç´¢å¼•ä¼˜åŒ–ï¼šdateã€session_typeã€session_id

## å…³é”®è®¾è®¡è§„èŒƒ

### ç•Œé¢å¸ƒå±€ç»“æ„

åº”ç”¨é‡‡ç”¨åµŒå¥— Scaffold ç»“æ„ï¼š
- **MainScreen**: å¤–å±‚ Scaffoldï¼Œç®¡ç† bottomBar (NavigationBar)
- **EventScreen/StopwatchScreen**: å†…å±‚ Scaffoldï¼Œç®¡ç†å„è‡ªçš„ topBar (TopAppBar)

**é¡µé¢å¸ƒå±€**ï¼ˆä»ä¸Šåˆ°ä¸‹ï¼‰ï¼š
1. TopAppBar (64.dp) - æ ‡é¢˜ + åˆ†äº«/å†å²/è®¾ç½®æŒ‰é’®
2. æ—¶é—´æ˜¾ç¤ºåŒº (160.dp) - è®¡æ—¶å™¨/ä¸–ç•Œæ—¶é—´ï¼ˆå›ºå®šé«˜åº¦ï¼‰
3. è®°å½•åˆ—è¡¨åŒº (weight 1f) - LazyColumnï¼ˆå¯æ»šåŠ¨ï¼Œå æ®å‰©ä½™ç©ºé—´ï¼‰
4. æ§åˆ¶æŒ‰é’®åŒº (96.dp) - æ“ä½œæŒ‰é’®ï¼ˆå›ºå®šé«˜åº¦ï¼‰
5. NavigationBar (åº•éƒ¨) - äº‹ä»¶/ç§’è¡¨ä¸¤ä¸ªæ ‡ç­¾

### æ—¶é—´æ ¼å¼åŒ–è§„èŒƒ

```kotlin
// ç»è¿‡æ—¶é—´æ ¼å¼: MM:SS.mmm (åˆ†:ç§’.æ¯«ç§’)
formatElapsed(nanos) -> "00:07.403"

// æ—¶é—´å·®æ ¼å¼: +MM:SS.mmm
formatSplit(nanos) -> "+00:07.403"

// ä¸–ç•Œæ—¶é—´æ ¼å¼ï¼ˆè®°å½•å¡ç‰‡ï¼‰: HH:mm:ss.SSS (æ—¶:åˆ†:ç§’.æ¯«ç§’)
formatWallClock(timestampMillis) -> "13:47:30.474"

// ä¸–ç•Œæ—¶é—´æ ¼å¼ï¼ˆä¸»ç•Œé¢æ˜¾ç¤ºï¼‰: yyyy-MM-dd HH:mm:ss (æ—¥æœŸ+æ—¶é—´ï¼Œä¸å«æ¯«ç§’)
formatWallClockWithDate(timestampMillis) -> "2025-11-10 13:47:37"

// åˆ†äº«ç”¨æ—¥æœŸæ ¼å¼: yyyy-MM-dd
formatShareDate(timestampMillis) -> "2025-11-10"
```

### æ“ä½œæµç¨‹è®¾è®¡

#### ç§’è¡¨æ¨¡å¼ - çŠ¶æ€æµè½¬
```
[åˆå§‹çŠ¶æ€]
  â†“ ç‚¹å‡»"å¼€å§‹"
[è¿è¡Œä¸­] - å·¦:[æ ‡è®°] å³:[æš‚åœ]
  â†“ ç‚¹å‡»"æš‚åœ"
[æš‚åœ] - å·¦:[ç»§ç»­] å³:[åœæ­¢]
  â†“ ç‚¹å‡»"åœæ­¢"
[å·²åœæ­¢] - æ˜¾ç¤º[é‡ç½®]æŒ‰é’®ï¼ˆå¯é€‰ä¿å­˜åˆ°å†å²ï¼‰
  â†“ ç‚¹å‡»"é‡ç½®"
[åˆå§‹çŠ¶æ€]
```

#### äº‹ä»¶æ¨¡å¼ - æ“ä½œæµç¨‹
```
[å§‹ç»ˆå°±ç»ª] - å·¦:[è®°å½•] å³:[é‡ç½®]
```

#### å½’æ¡£é€»è¾‘

**äº‹ä»¶æ¨¡å¼ï¼ˆè‡ªåŠ¨å½’æ¡£ï¼‰**ï¼š
- MainActivity å¯åŠ¨æ—¶æ£€æŸ¥æ˜¯å¦è·¨è¿‡åˆ†ç•Œç‚¹ï¼ˆé»˜è®¤ 00:00ï¼‰
- è·¨å¤©åˆ¤æ–­ï¼šä½¿ç”¨åˆ†é’Ÿçº§æ—¶é—´æ¯”è¾ƒï¼ˆ0-1439ï¼‰ï¼Œæ—¥æœŸå˜åŒ–ä¸”å·²è¿‡åˆ†ç•Œç‚¹æ—¶è§¦å‘
- å½’æ¡£æ“ä½œï¼šä» DataStore ç§»åŠ¨åˆ° Room æ•°æ®åº“ï¼Œæ¸…ç©ºå·¥ä½œåŒºï¼ŒToast æç¤ºç”¨æˆ·

**ç§’è¡¨æ¨¡å¼ï¼ˆæ‰‹åŠ¨å½’æ¡£ï¼‰**ï¼š
- ç§’è¡¨åœæ­¢åå¼¹å‡ºä¿å­˜ç¡®è®¤å¯¹è¯æ¡†
- ç”Ÿæˆé»˜è®¤æ ‡é¢˜ï¼š"ä¼šè¯ HH:mm"ï¼ˆåŸºäºå¼€å§‹æ—¶é—´ï¼‰ï¼Œç”¨æˆ·å¯ä¿®æ”¹
- å½’æ¡£æ“ä½œï¼šä¿å­˜åˆ° Room æ•°æ®åº“ï¼Œæ¸…ç©º DataStore å·¥ä½œåŒºï¼Œé‡ç½®çŠ¶æ€

### å…±äº«ç»„ä»¶è®¾è®¡

é€šè¿‡ä»£ç é‡æ„æå–äº† 6 ä¸ªå…±äº«ç»„ä»¶ï¼š

1. **ModeNavigationBar** (65 è¡Œ) - äº‹ä»¶/ç§’è¡¨åº•éƒ¨å¯¼èˆªæ ï¼ˆæ³›å‹è®¾è®¡ï¼‰
2. **ConfirmDialog** (94 è¡Œ) - ç»Ÿä¸€çš„ç¡®è®¤å¯¹è¯æ¡†ï¼ˆ7 å¤„å¤ç”¨ï¼‰
3. **EditRecordDialog** (204 è¡Œ) - ç»Ÿä¸€çš„è®°å½•ç¼–è¾‘å¯¹è¯æ¡†ï¼ˆæ”¯æŒå‡½æ•°é‡è½½ï¼‰
4. **UnifiedRecordCard** (187 è¡Œ) - ç»Ÿä¸€çš„è®°å½•å¡ç‰‡ï¼ˆæ”¯æŒ 4 ç§æ¨¡å¼ï¼‰
5. **ControlButton** (69 è¡Œ) - ç»Ÿä¸€çš„åœ†å½¢æ§åˆ¶æŒ‰é’®
6. **RecordCardMode** (22 è¡Œ) - å¡ç‰‡æ¨¡å¼æšä¸¾

**è®¾è®¡åŸåˆ™**ï¼š
- ä¿æŒ Screen æ–‡ä»¶å®Œæ•´æ€§å’Œå¯è¯»æ€§
- åªæå–çœŸæ­£å¯å¤ç”¨çš„ç»„ä»¶ï¼ˆé‡å¤åº¦ > 60%ï¼‰
- åˆ†å±‚æ¸…æ™°ï¼šScreen å±‚ â†’ Components å±‚ â†’ ViewModel å±‚

**é‡æ„æˆæœ**ï¼š
- å‡å°‘é‡å¤ä»£ç  ~600 è¡Œï¼ˆ-86%ï¼‰
- UI ä¸€è‡´æ€§ä» 70% æå‡è‡³ 95%
- ä»£ç å¤ç”¨ç‡ä» 0% æå‡è‡³ 40%+
- ç»´æŠ¤æˆæœ¬æ˜¾è‘—é™ä½ï¼ˆä¿®æ”¹ä¸€æ¬¡ï¼Œå…¨å±€ç”Ÿæ•ˆï¼‰

## å¼€å‘æ³¨æ„äº‹é¡¹

### JDK é…ç½®
- **Gradle JDK**: ä½¿ç”¨ Android Studio è‡ªå¸¦çš„ **JetBrains Runtime 21**
- **é¡¹ç›®ç¼–è¯‘ç›®æ ‡**: **Java 17**
  - `sourceCompatibility / targetCompatibility = JavaVersion.VERSION_17`
  - `kotlinOptions.jvmTarget = "17"`

### é«˜ç²¾åº¦è®¡æ—¶å®ç°

```kotlin
// ä½¿ç”¨ nanoTime() è€Œé currentTimeMillis()
private var startTimeNanos: Long = 0L
private var pausedTimeNanos: Long = 0L

fun getCurrentElapsedTime(): Long {
    return System.nanoTime() - startTimeNanos - pausedTimeNanos
}
```

### åç¨‹è®¡æ—¶æ›´æ–°

```kotlin
// è®¡æ—¶å™¨æ›´æ–°ï¼ˆä»…åœ¨è¿è¡Œæ—¶æ‰§è¡Œï¼‰
private fun startTimerTicking() {
    timerJob = viewModelScope.launch {
        while (isActive) {
            delay(10)  // æ¯ 10ms æ›´æ–°ä¸€æ¬¡è®¡æ—¶å™¨
            updateCurrentTime()
        }
    }
}

// ä¸–ç•Œæ—¶é—´æ›´æ–°ï¼ˆå§‹ç»ˆè¿è¡Œï¼Œç‹¬ç«‹äºç§’è¡¨çŠ¶æ€ï¼‰
private fun startWallClockTicking() {
    wallClockJob = viewModelScope.launch {
        while (isActive) {
            updateWallClock()
            delay(1000)  // æ¯ç§’æ›´æ–°ä¸€æ¬¡ä¸–ç•Œæ—¶é—´
        }
    }
}

// åœ¨ ViewModel çš„ init å—ä¸­å¯åŠ¨ä¸–ç•Œæ—¶é—´
init {
    startWallClockTicking()
}
```

### R8 ä»£ç æ··æ·†

é¡¹ç›®å·²å¯ç”¨ R8 ä»£ç æ··æ·†ï¼ˆ`isMinifyEnabled = true`ï¼‰ï¼Œå…³é”®é…ç½®ï¼š

- ä¿ç•™ Room æ•°æ®åº“ç›¸å…³ç±»
- ä¿ç•™ DataStore Preferences
- ä¿ç•™ Kotlinx Serialization
- ä¿ç•™ Compose ç›¸å…³ç±»
- ä¿ç•™ ViewModel
- ä¿ç•™æ•°æ®æ¨¡å‹ç±»ï¼ˆç”¨äºåºåˆ—åŒ–ï¼‰
- ä¿ç•™æšä¸¾ç±»
- ä¿ç•™è°ƒè¯•ä¿¡æ¯ï¼ˆSourceFile, LineNumberTableï¼‰

æ„å»º Release APK æ—¶ä¼šç”Ÿæˆ `mapping.txt`ï¼ˆ182MBï¼‰ï¼Œç”¨äºè¿˜åŸæ··æ·†åçš„å †æ ˆè·Ÿè¸ªã€‚

### å¼€å‘å»ºè®®

- **é«˜ç²¾åº¦è®¡æ—¶**: ä½¿ç”¨ `System.nanoTime()` è·å–çº³ç§’çº§ç²¾åº¦
- **æ—¶é—´æ ¼å¼åŒ–**: ä½¿ç”¨ `java.time` APIï¼ˆSDK 26+ åŸç”Ÿæ”¯æŒï¼‰
- **è®¡æ—¶æ›´æ–°é¢‘ç‡**: æ¯ 10ms æ›´æ–°ä¸€æ¬¡è®¡æ—¶å™¨ï¼Œç¡®ä¿æ¯«ç§’ç²¾åº¦æ˜¾ç¤º
- **ä¸–ç•Œæ—¶é—´æ›´æ–°**: ç‹¬ç«‹åç¨‹æ¯ç§’æ›´æ–°ä¸€æ¬¡ï¼Œä¸å—ç§’è¡¨çŠ¶æ€å½±å“
- **çŠ¶æ€ç®¡ç†**: ä½¿ç”¨ StateFlow ç¡®ä¿ UI çŠ¶æ€å•å‘æ•°æ®æµ
- **æ ‡è®°æ“ä½œ**: å¿…é¡»ç¬é—´å®Œæˆï¼Œä¸èƒ½ä¸­æ–­è®¡æ—¶æµç¨‹
- **æ•°æ®æŒä¹…åŒ–**: DataStore ç”¨äºè½»é‡çº§æ•°æ®ï¼ŒRoom ç”¨äºå†å²è®°å½•

### Git Commit è§„èŒƒ

éµå¾ª Angular Commit Message Conventionï¼ŒSubject å’Œ Body ä½¿ç”¨ä¸­æ–‡ç¼–å†™ã€‚

**ç¤ºä¾‹**ï¼š
```
feat: æ·»åŠ äº‹ä»¶æ¨¡å¼è‡ªåŠ¨å½’æ¡£åŠŸèƒ½

- åœ¨ MainActivity å¯åŠ¨æ—¶æ£€æŸ¥æ˜¯å¦è·¨è¿‡åˆ†ç•Œç‚¹
- ä½¿ç”¨é€»è¾‘æ—¥æœŸè®¡ç®—å½’æ¡£æ—¶æœº
- å½’æ¡£åæ˜¾ç¤º Toast æç¤ºç”¨æˆ·
```