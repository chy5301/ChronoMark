# Changelog

本文件用于记录 ChronoMark 的所有重要变更。

本文件格式参考 [Keep a Changelog](https://keepachangelog.com/en/1.0.0/)。

## [Unreleased]

### 计划功能
- 统计功能：记录数趋势图
- 搜索功能：按备注搜索
- 标签系统：工作/学习/运动分类
- 批量导出历史：CSV/JSON 格式

## [1.1.0] - 2026-02-01

### 新增功能
- ✨ 应用内版本更新检查（Gitee + GitHub 双源策略）
- ✨ 启动时自动检查更新（24小时间隔）
- ✨ 设置页手动检查更新按钮
- ✨ 更新通道切换（Gitee优先/GitHub优先）
- ✨ 版本忽略功能

### 界面优化
- 🎨 记录卡片备注显示限制为 3 行，超出显示省略号
- 🎨 编辑对话框备注输入框扩大（3-8 行）
- 🎨 事件模式编辑对话框不再显示无意义的累计时间

### 技术改进
- 🔧 单元测试覆盖（VersionUtils、UpdateChecker）

## [1.0.2] - 2026-02-01

### 新增功能
- ✨ 时区变化检测：启动时检测系统时区变化并提示用户

### 问题修复
- 🐛 修复历史版本数据迁移后序号混乱的问题（数据库版本升级 v1→v2）

### 技术改进
- 🔧 CI/CD: 移除 mapping.txt.gz 从发布文件列表
- 🔧 文档: 精简 CLAUDE.md 项目文档

## [1.0.1] - 2026-01-30

### 新增功能
- ✨ 主界面双击返回退出，避免误触退出应用

### 问题修复
- 🐛 修复事件模式历史记录问题，重构为实时同步架构

### 技术改进
- 🔧 添加单元测试基础设施和事件模式测试用例
- 🔧 添加 GitHub Actions 自动发布和 CI 工作流
- 🔧 支持本地和 CI 双模式签名配置

## [1.0.0] - 2025-12-31

### 新增功能
- ✨ **事件模式**：一键记录当前时刻，无需启动计时器，适合快速记录观察点、重要时刻或时间节点
- ✨ **秒表模式**：高精度计时（毫秒级），支持开始/暂停/继续/停止/标记，运行中可瞬间标记时间点
- ✨ **双时间显示**：计时器时间 + 世界时间（精确到毫秒），不仅知道"经过了多久"，还能追溯"何时发生"
- ✨ **历史记录**：事件模式自动按天归档，秒表模式手动保存会话，支持查看、分享、管理历史数据
- ✨ **自定义归档分界点**：基于逻辑日期的智能归档（如 04:00 前记录归档到前一天）
- ✨ **数据持久化**：应用重启后自动恢复状态和记录（DataStore + Room 数据库）
- ✨ **分享功能**：一键生成格式化文本，可分享到任意应用或复制到剪贴板
- ✨ **设置选项**：主题模式切换、保持屏幕常亮、震动反馈、历史记录管理

### 技术优化
- 🔧 **代码重构**：提取 6 个共享组件，减少 86% 重复代码，UI 一致性提升至 95%
- 🔧 **R8 代码混淆**：APK 体积优化 30-40%，提升应用安全性和性能
- 🔧 **Material3 主题**：支持亮色/深色模式自适应
- 🔧 **Room 数据库**：高效的历史记录存储和查询
- 🔧 **高精度计时**：使用 nanoTime 实现毫秒级精度

### 架构改进
- 📦 **MVVM 架构**：清晰的职责分离，ViewModel 管理业务逻辑
- 📦 **共享组件层**：统一 UI 样式和交互逻辑
  - ModeNavigationBar：泛型导航栏
  - UnifiedRecordCard：统一记录卡片
  - ConfirmDialog：通用确认对话框
  - EditRecordDialog：记录编辑对话框
  - ControlButton：圆形控制按钮
- 📦 **逻辑日期概念**：智能的跨天归档处理

### 已知问题（待下个版本优化）
- ⚠️ 主界面返回键直接退出应用，建议改为"再次返回退出"提示
- ⚠️ 记录描述文本显示长度需要优化
